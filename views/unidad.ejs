<!DOCTYPE html>
<html lang="ar">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.rtl.min.css"
      integrity="sha384-OXTEbYDqaX2ZY/BOaZV/yFGChYHtrXH2nyXJ372n2Y8abBhrqacCEe+3qhSHtLjy"
      crossorigin="anonymous"
    />

    <title>Unidad</title>
  </head>
  <body>
    <%- include('partials/navigation') %>
    <nav aria-label="Page navigation example">
      <ul class="pagination">
        <li class="page-item">
          <a
            class="page-link"
            href="http://localhost:3008/api/v1/unidad?limit=8&&offset=0"
            aria-label="Previous"
          >
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item">
          <a
            class="page-link"
            href="http://localhost:3009/api/v1/unidad?limit=8&&offset=0"
            >1</a
          >
        </li>
        <li class="page-item">
          <a
            class="page-link"
            href="http://localhost:3009/api/v1/unidad?limit=11&&offset=9"
            >2</a
          >
        </li>
        <li class="page-item">
          <a
            class="page-link"
            href="http://localhost:3008/api/v1/unidad?limit=11&&offset=9"
            aria-label="Next"
          >
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
    <br />
    <!-- Modal crear -->
    <div class="modal" tabindex="-1" id="modalUnidad">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Creacion Cliente</h5>
          </div>
          <div class="modal-body">
            <div style="background-color: red; display: flex; width: 10%">
              <span id="err"></span>
            </div>
            <form id="formular" action="">
              <div class="mb-3">
                <label for="user" class="form-label">descripcion Unidad</label>
                <input
                  type="text"
                  class="form-control"
                  id="uniddesc"
                  name="uniddesc"
                  tabindex="1"
                />
                <label for="user" class="form-label"
                  >descripcion Corta Unidad</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="uniddeco"
                  name="uniddeco"
                  tabindex="1"
                />
              </div>
              <div class="mb-3">
                <!-- <label for="user" class="form-label">Rol</label>
            <select id="rol" name="rol" class="form-select" aria-label="Default select example" tabindex="2">
                <option value="admin" selected>Admin</option>
                <option value="data entry">Data Entry</option>
            </select> -->
              </div>
              <button id="btnCliente" class="btn btn-primary" tabindex="5" onclick="createCliente()">
                Guardar
              </button>
              <a href="" data-bs-dismiss="modal" class="btn btn-secondary"
                >Cancelar</a
              >
            </form>
          </div>
          <div class="modal-footer"></div>
        </div>
      </div>
    </div>

    <!-- Modal editar -->
    <div class="modal" tabindex="-1" id="modal_edit">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
          </div>
          <div class="modal-body">
            <form action="/api/v1/unidad" method="post">
              <div class="mb-3">
                <label for="user" class="form-label">ID</label>
                <input
                  type="text"
                  class="form-control"
                  id="id"
                  name="id"
                  tabindex="1"
                  disabled
                />
                <label for="user" class="form-label">descripcion Unidad</label>
                <input
                  type="text"
                  class="form-control"
                  id="uniddesc"
                  name="uniddesc"
                  tabindex="1"
                />
                <label for="user" class="form-label"
                  >descripcion Corta Unidad</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="uniddeco"
                  name="uniddeco"
                  tabindex="1"
                />
              </div>
              <div class="mb-3">
                <!-- <label for="user" class="form-label">Rol</label>
              <select id="rol" name="rol" class="form-select" aria-label="Default select example" tabindex="2">
                  <option value="admin" selected>Admin</option>
                  <option value="data entry">Data Entry</option>
              </select> -->
              </div>
              <button type="submit" class="btn btn-primary" tabindex="5">
                Guardar
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </form>
          </div>
          <div class="modal-footer"></div>
        </div>
      </div>
    </div>

    <!--  -->

    <div class="container">
      <a
        style="position: relative; bottom: 40px"
        href=""
        class="btn btn-outline-primary"
        data-bs-toggle="modal"
        data-bs-target="#modalUnidad"
        >Create</a
      >
      <table
        style="position: relative; bottom: 55px"
        class="table table-hover table-bordered-primary table-striped text-center mt-4 position"
      >
        <thead>
          <tr class="bg-primary text-white">
            <th scope="col">ID</th>
            <th scope="col">Descripcion</th>
            <th scope="col">Descripcion Corta</th>
            <th scope="col">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <% unidades.forEach((users)=> {%>
          <tr>
            <td><%= users.unidid %></td>
            <td><%= users.uniddesc %></td>
            <td><%= users.uniddeco %></td>
            <td>
              <a
                class="btn btn-outline-info"
                data-bs-toggle="modal"
                data-bs-target="#modal_edit"
                >Editar</a
              >
              <a href="/delete" class="btn btn-outline-danger">Delete</a>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
      crossorigin="anonymous"
    ></script>
    <script>
      //const  formulario = document.getElementById('')
      const url = 'http://localhost:3009/api/v1/unidad';
      async function createCliente() {
        try {
          const form = document.getElementById("formular");
          const newCliente = new FormData(form);
          const dexcrip = newCliente.get("uniddeco");
          const descoprr = newCliente.get("uniddesc");
          console.log(dexcrip);
          console.log(descoprr);
          const datos = {
            uniddesc:descoprr ,
            uniddeco:dexcrip,
          }

          const res = await fetch(url, {
            method: "POST", // or 'PUT'
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(datos),
          });

          const data = await res.json();
          console.log("mensage", data.message || "nada");
        } catch (error) {
          console.error(error);
        }
      }
    </script>
  </body>
</html>
